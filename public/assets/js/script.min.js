/* Author:
	@adamcbrewer
*/$(function(e){var t=function(e){e=e||{};var t={init:function(){this._setup()},createAvatar:function(){this.avatar=$("<div>");this.avatar.attr({"class":"person troll","data-id":this.id,"data-posx":"","data-posy":""}).css({"background-image":"url("+this.profileImg+")"});this.avatar.append('<span class="name">'+this.name+"</span>")},_setup:function(){this.createAvatar()},_bindEvents:function(){}};t.profile=e;t.id=e.id||null;t.name=e.name||"Trololo";t.profileImg=e.profileImg||"http://s3.amazonaws.com/ragefaces/fed47e7ffa874d01b771474d2eef1a60.png";t.init();return t},n=function(e){e=e||{};var t={init:function(){this._setup()},createAvatar:function(){this.avatar=$("<div>");this.avatar.attr({"class":"person","data-id":this.id,"data-posx":"","data-posy":""}).css({"background-image":"url("+this.profileImg+")"});this.avatar.append('<span class="name">'+this.name+"</span>")},_setup:function(){this.createAvatar()},_bindEvents:function(){}};t.profile=e;t.id=e.id;t.name=e.name;t.profileImg=e.profile_image_url;t.init();return t},r={init:function(){this._setup();this.getProfiles()},getProfiles:function(){var e=this,r="https://api.twitter.com/1/users/lookup.json?screen_name="+this.twitterList.join(",")+"&include_entities=true&callback=?",i="http://ragefac.es/api/id/100?callback=?",s=[];$.getJSON(r,function(r){s=r;s.forEach(function(t){e.profiles.push(new n(t))});e.trollList.forEach(function(n){e.profiles.push(new t(n))});e.placePeopleInOffice()})},placePeopleInOffice:function(){var e=this.floor;this.profiles.forEach(function(t,n){e.append(t.avatar)});this.initDragging()},initDragging:function(){var e=this;this.people=this.floor.find(".person");this.draggable=this.people.draggable({grid:[45,45],containment:"parent",addClasses:!1,create:function(e,t){},start:function(t,n){e.people.not(this).removeClass("dragging");e.people.filter(this).addClass("dragging")},drag:function(e,t){},stop:function(t,n){e.people.removeClass("last-drag").filter(this).addClass("last-drag").removeClass("dragging");e.updatePersonData(this).updateProfile(this)}}).data("draggable")},updatePersonData:function(e){var t=parseInt(e.style.top,10),n=parseInt(e.style.left,10);e.setAttribute("data-posx",t);e.setAttribute("data-posy",n);return this},updateProfile:function(e){this.profiles.forEach(function(t){t.id==e.getAttribute("data-id")&&(t.data={x:e.getAttribute("data-posx"),y:e.getAttribute("data-posy")});return})},serialize:function(){var e=this},_setup:function(){this.twitterList=["adamcbrewer","mikemackay","natevan","NeilCarpenter","AsWeb85","gregfindon","di_lucca","dggomes"];this.trollList=[{id:"001",name:"Paul Lawton"},{id:"002",name:"Binki",profileImg:"http://s3.amazonaws.com/ragefaces/14af359aa586642a8fcd51119d829955.png"}];this.floor=$("#floor");this.people=[];this.profiles=[]}}}(Site));